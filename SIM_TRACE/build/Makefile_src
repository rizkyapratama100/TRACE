################################################################################
# Makefile:
#    This is a makefile for maintaining the
#    '/home/rizky-ubuntu/TRACE/SIM_TRACE'
#    simulation directory. This makefile was automatically generated by trick-CP
#
################################################################################
# Creation:
#    Author: Trick Configuration Processor - trick-CP Version 19.8.0-beta
#    Date:   Thu Feb 13 17:33:04 2025
#
################################################################################

ifdef VERBOSE
    TRICK_VERBOSE_BUILD=1
endif

ifndef TRICK_VERBOSE_BUILD
    PRINT_COMPILE    = $(info $(call COLOR,Compiling)  $<)
    PRINT_EXE_LINK   = $(info $(call COLOR,Linking)    $@)
    PRINT_SIE        = $(info $(call COLOR,Writing)    $@)
endif

S_MAIN  = S_main_${TRICK_HOST_CPU}.exe
ifeq ($(MAKECMDGOALS), test)
    TRICK_HOST_CPU := $(shell $(TRICK_HOME)/bin/trick-gte TRICK_HOST_CPU)_test
    S_MAIN  = T_main_${TRICK_HOST_CPU}.exe
endif

# S_OBJECTS ====================================================================

S_OBJECTS = build/S_source.o

build/S_source.o: build/S_source.cpp | build/S_source.d
	$(PRINT_COMPILE)
	$(call ECHO_AND_LOG,$(TRICK_CXX) $(TRICK_CXXFLAGS) $(TRICK_SYSTEM_CXXFLAGS) -MMD -MP -c -o $@ $<)

build/S_source.d: ;

-include build/S_source.d

# MODEL_OBJECTS ================================================================

# This function allows users to specify target-specific variables for individual
# or groups of source files. For example:
# $(call FIND_MODEL_OBJECTS, /path/to/file /path/to/directory $(LIST_OF_PATHS)): TRICK_CXXFLAGS += -Werror
FIND_MODEL_OBJECTS = $(foreach PATH, $1, $(filter $(addprefix build, $(addsuffix %, $(PATH))), $(MODEL_OBJECTS)))

MODEL_OBJECTS.c := \
    build/home/rizky-ubuntu/TRACE/SIM_TRACE/models/ball/src/robot_init.o \
    build/home/rizky-ubuntu/TRACE/SIM_TRACE/models/ball/src/robot_numeric.o \
    build/home/rizky-ubuntu/TRACE/SIM_TRACE/models/ball/src/robot_shutdown.o

MODEL_OBJECTS := ${MODEL_OBJECTS.c}

# We use .SECONDEXPANSION here to allow us to use automatic vairiables in the prerequisite list
# in order to add to each target an order-only dependency on its directory.
# See https://www.gnu.org/software/make/manual/html_node/Automatic-Variables.html
# and https://www.gnu.org/software/make/manual/html_node/Secondary-Expansion.html

.SECONDEXPANSION:

${MODEL_OBJECTS.c} : build/%.o : /%.c | build/%.d $$(dir $$@)
	$(PRINT_COMPILE)
	$(call ECHO_AND_LOG,$(TRICK_CC) $(TRICK_CFLAGS) $(TRICK_SYSTEM_CFLAGS) -I$(<D)/../include -MMD -MP -c -o $@ $<)

$(sort $(dir $(MODEL_OBJECTS))):
	@mkdir -p $@

$(MODEL_OBJECTS:.o=.d): ;

-include $(MODEL_OBJECTS:.o=.d)

LINK_LISTS += $(LD_FILELIST)build/model_link_list

# S_MAIN =======================================================================

READ_ONLY_LIBS =

all: S_sie.resource

$(S_MAIN): S_source.hh $(TRICK_STATIC_LIB) $(S_OBJECTS) $(MODEL_OBJECTS)
	$(PRINT_EXE_LINK)
	$(call ECHO_AND_LOG,$(TRICK_CXX) -o $@ $(TRICK_SYSTEM_LDFLAGS) $(S_OBJECTS) $(LINK_LISTS) $(TRICK_LDFLAGS) $(TRICK_USER_LINK_LIBS) $(READ_ONLY_LIBS) $(LD_WHOLE_ARCHIVE) $(TRICK_LIBS) $(LD_NO_WHOLE_ARCHIVE) $(TRICK_EXEC_LINK_LIBS))

# SIE ==========================================================================

S_sie.resource: $(S_MAIN)
	$(PRINT_SIE)
	$(call ECHO_AND_LOG,${TRICK_HOME}/$(LIBEXEC)/trick/sie_concat)